@inject Data.TranslationService _ts
@inject Data.PostService _ps

<MudDialog>
    <DialogContent>
        @if (Post is not null)
        {
            <MudStack>
                @foreach (var item in Post.Votings)
                {
                    if (string.IsNullOrEmpty(item.Text))
                    {
                        continue;
                    }

                    <MudPaper Class="pa-3">
                        <MudStack Row="true" Justify="Justify.SpaceBetween">
                            <MudText Typo="Typo.h6">@GetUserName(item.UserId)</MudText>
                            @if (item.Like)
                            {
                                <MudIcon Icon="@Icons.Material.Filled.ThumbUpAlt" />
                            }
                            else
                            {
                                <MudIcon Icon="@Icons.Material.Filled.ThumbDownAlt" />
                            }
                        </MudStack>
                        <MudDivider Class="mt-2 mb-2" />
                        <MudText>
                            @item.Text
                        </MudText>
                    </MudPaper>
                }
            </MudStack>
        }
    </DialogContent>
    <DialogActions>
        <MudButton Color="Color.Primary" OnClick="Submit">@_ts.I18n.Ok</MudButton>
    </DialogActions>
</MudDialog>

@code {

    [CascadingParameter]
    private IMudDialogInstance? MudDialog { get; set; }

    [Parameter]
    public Post? Post { get; set; }

    private async Task Submit() => MudDialog?.Close();

    private string GetUserName(string id)
    {
        var u = _ps.Users.FirstOrDefault(x => x.Id == id);
        if (u is not null)
        {
            return u.GetName();
        }

        return _ts.I18n.Unknown;
    }
}
